
<!DOCTYPE html>
<html lang="sa">
<head>
  <meta charset="UTF-8">
  <title>N─АRA Agent Runner</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 2em; }
    textarea { width: 100%; height: 200px; font-size: 1em; font-family: monospace; }
    button { padding: 0.5em 1em; font-size: 1em; margin-top: 1em; }
    pre { background: #fff; padding: 1em; border: 1px solid #ccc; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>ЁЯХЙя╕П N─АRA Web Agent Runner with Memory + Feedback</h1>
  <p>Enter your Sanskrit `.nara` code below:</p>
  
  <p>Describe your emotion or ask the Guru directly:</p>
  <input type="text" id="userPrompt" style="width:100%;padding:0.5em;font-size:1em;" placeholder="e.g., I feel disconnected or anxious">
  <br><br>
<textarea id="naraInput">// рдкреБрд░реБрд╖рдГ рд╡реИрджреНрдпрдГ рдЕрд╕реНрддрд┐ { рдЧреБрдгрд╛рдГ: ["рд╕рд╣рд╛рдиреБрднреВрддрд┐"] рдкреНрд░рд╡реЗрд╢рдГ: рдЖрд░реЛрдЧреНрдп_рд╕реНрдерд┐рддрд┐ рдирд┐рд░реНрдЧрдордГ: рдорд╛рд░реНрдЧрджрд░реНрд╢рди_рдпреЛрдЬрдирд╛ }</textarea>
  <br>
  <button onclick="runNara()">ЁЯФБ Run Agent</button>
  <button onclick="resetMemory()">ЁЯз╣ Reset Memory</button>
  
  <button onclick="saveSession()">ЁЯТ╛ Save Session</button>
  <button onclick="loadSession()">ЁЯУВ Load Session</button>

  <pre id="output">Output will appear here...</pre>
  <h3>ЁЯУК Memory Evolution</h3>
  <h3>ЁЯдЦ рдмреБрджреНрдзрд┐рд╕рдВрд╡рд╛рдж (LLM Agent Response)</h3>
  <pre id="llmResponse" style="background:#eef; padding:1em; border:1px solid #99f; white-space:pre-wrap; height:120px; overflow:auto;">LLM response will appear here...</pre>

  <div id="memoryLog" style="background:#fff; padding:1em; border:1px solid #ccc; white-space:pre-wrap; height:200px; overflow:auto;"></div>

  <script>
    let memory = {};

    function validateNara(code) {
      const errors = [];
      if (!code.includes("рдкреБрд░реБрд╖рдГ") || !code.includes("рдЕрд╕реНрддрд┐")) {
        errors.push("тЭМ Missing agent declaration using 'рдкреБрд░реБрд╖рдГ ... рдЕрд╕реНрддрд┐'");
      }
      if (!code.includes("рдкреНрд░рд╡реЗрд╢рдГ") || !code.includes("рдирд┐рд░реНрдЧрдордГ")) {
        errors.push("тЭМ Missing 'рдкреНрд░рд╡реЗрд╢рдГ' (input) or 'рдирд┐рд░реНрдЧрдордГ' (output) section");
      }
      if (!code.includes("рдХрд░реНрдореЗ")) {
        errors.push("тЭМ Missing task definition using 'рдХрд░реНрдореЗ ... рдпрджрд╛'");
      }
      if (!code.includes("рдпрджрд┐")) {
        errors.push("тЭМ Missing conditional logic using 'рдпрджрд┐'");
      }
      return errors;
    }

    function runNara() {
      const input = document.getElementById("naraInput").value;
      const validationErrors = validateNara(input);
      let output = "ЁЯУЬ Validation Results:\n";

      if (validationErrors.length > 0) {
        output += validationErrors.join("\n") + "\n\nExecution skipped due to syntax errors.";
        document.getElementById("output").textContent = output;

      // Simulated LLM agent response
      const llmOut = input.includes("рдЪрд┐рдиреНрддрд╛рдпреБрдХреНрддрдГ") ?
        "ЁЯТм [Guru AI]: рдзреНрдпрд╛рдирдВ рдХреБрд░реНрд╡, рдЪрдХреНрд░ рд╕рдиреНрддреБрд▓рдирдВ рдкреНрд░рд╛рдкреНрддрд╡реНрдпрдВред" :
        "ЁЯТм [Guru AI]: рд╕рдореНрдпрдХреН рд╕реНрдерд┐рддрд┐ тАФ рд╕реНрдореГрддреНрдпрд╛ рд╕рд╣ рд╕рд╛рдордЮреНрдЬрд╕реНрдпрдВ рд╕реНрдерд╛рдкрд┐рддрдореНред";
      fetchLLMResponse(input);
    

      const memoryLog = document.getElementById("memoryLog");
      const timestamp = new Date().toLocaleTimeString();
      const memSnapshot = JSON.stringify(memory, null, 2);
      memoryLog.textContent += `[${timestamp}]\n` + memSnapshot + "\n\n";
    
        return;
      }

      output += "тЬЕ Syntax valid. Executing agent...\n\n";
      output += "ЁЯза рд╕реНрдореГрддрд┐ рд╕реНрдерд┐рддрд┐ (Memory State):\n";
      output += JSON.stringify(memory, null, 2) + "\n\n";

      if (input.includes("рдЪрд┐рдиреНрддрд╛рдпреБрдХреНрддрдГ")) {
        output += "ЁЯзШ рдЪрд┐рдиреНрддрд╛рдпреБрдХреНрддрдГ detected. Activating calm protocol: рдЪрдХреНрд░ рд╕рдиреНрддреБрд▓рди\n";
        memory["рднрд╛рд╡рдирд╛"] = "рд╢рд╛рдиреНрдд";
      } else {
        output += "ЁЯФо Defaulting to рд╕рд╛рдордЮреНрдЬрд╕реНрдп AI рд╕реНрдореГрддрд┐ layer\n";
        memory["рднрд╛рд╡рдирд╛"] = "рд╕рд╛рдорд╛рдиреНрдп";
      }

      if (input.includes("!= \"рд╕рдиреНрддреБрд▓рд┐рддрдореН\"")) {
        output += "ЁЯФБ рдкреНрд░рддреНрдпреБрдкрдХрд░реНрд╖рдГ: рдкрд░рд┐рдгрд╛рдо рдЕрд╕рдиреНрддреБрд▓рд┐рддрдореН тАФ рд╢рд┐рдХреНрд╖рд╛рдВ рдЖрд░рднрддреЗ\n";
        memory["рдЕрднреНрдпрд╛рд╕рдГ"] = "рд╕рдХреНрд░рд┐рдп";
      } else {
        output += "тЬЕ рд╕рдиреНрддреБрд▓рди рд╕рд┐рджреНрдзрдГ тАФ рдкреБрдирд╢рд┐рдХреНрд╖рдгрдВ рдЖрд╡рд╢реНрдпрдХрдВ рди\n";
        memory["рдЕрднреНрдпрд╛рд╕рдГ"] = "рд╕реНрдердЧрд┐рдд";
      }

      document.getElementById("output").textContent = output;

      // Simulated LLM agent response
      const llmOut = input.includes("рдЪрд┐рдиреНрддрд╛рдпреБрдХреНрддрдГ") ?
        "ЁЯТм [Guru AI]: рдзреНрдпрд╛рдирдВ рдХреБрд░реНрд╡, рдЪрдХреНрд░ рд╕рдиреНрддреБрд▓рдирдВ рдкреНрд░рд╛рдкреНрддрд╡реНрдпрдВред" :
        "ЁЯТм [Guru AI]: рд╕рдореНрдпрдХреН рд╕реНрдерд┐рддрд┐ тАФ рд╕реНрдореГрддреНрдпрд╛ рд╕рд╣ рд╕рд╛рдордЮреНрдЬрд╕реНрдпрдВ рд╕реНрдерд╛рдкрд┐рддрдореНред";
      fetchLLMResponse(input);
    

      const memoryLog = document.getElementById("memoryLog");
      const timestamp = new Date().toLocaleTimeString();
      const memSnapshot = JSON.stringify(memory, null, 2);
      memoryLog.textContent += `[${timestamp}]\n` + memSnapshot + "\n\n";
    
    }

    
    function saveSession() {
      const code = document.getElementById("naraInput").value;
      localStorage.setItem("nara_code", code);
      localStorage.setItem("nara_memory", JSON.stringify(memory));
      document.getElementById("output").textContent = "ЁЯТ╛ Session saved to localStorage.";
    }

    function loadSession() {
      const code = localStorage.getItem("nara_code");
      const mem = localStorage.getItem("nara_memory");
      if (code) document.getElementById("naraInput").value = code;
      if (mem) memory = JSON.parse(mem);
      document.getElementById("output").textContent = "ЁЯУВ Session loaded from localStorage.";
    }

    
    function fetchLLMResponse(code) {
      fetch("https://nara-llm-agent.onrender.com/api/guru", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          code: code,
          context: code.includes("рдЪрд┐рдиреНрддрд╛рдпреБрдХреНрддрдГ") ? "User is anxious" : "Neutral"
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.reply) {
          document.getElementById("llmResponse").textContent = "ЁЯФо " + data.reply;
        } else {
          document.getElementById("llmResponse").textContent = "тЪая╕П Error: " + (data.error || "No reply.");
        }
      })
      .catch(err => {
        document.getElementById("llmResponse").textContent = "тЭМ LLM API error: " + err;
      });
    }
    
    
    function simulateTyping(text, elementId, delay = 40) {
      const el = document.getElementById(elementId);
      el.textContent = "";
      let i = 0;
      const interval = setInterval(() => {
        el.textContent += text[i];
        i++;
        if (i >= text.length) clearInterval(interval);
      }, delay);
    }

    function fetchLLMResponse(code) {
      const userPrompt = document.getElementById("userPrompt").value;
      fetch("https://nara-llm-agent.onrender.com/api/guru", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          code: code,
          context: userPrompt || (code.includes("рдЪрд┐рдиреНрддрд╛рдпреБрдХреНрддрдГ") ? "User is anxious" : "Neutral")
        })
      })
      .then(res => res.json())
      .then(data => {
        if (data.reply) {
          simulateTyping("ЁЯФо " + data.reply, "llmResponse");
        } else {
          document.getElementById("llmResponse").textContent = "тЪая╕П Error: " + (data.error || "No reply.");
        }
      })
      .catch(err => {
        document.getElementById("llmResponse").textContent = "тЭМ LLM API error: " + err;
      });
    }
    
    function resetMemory() {
      memory = {};
      document.getElementById("output").textContent = "ЁЯз╣ Memory has been cleared.";
    }
  
  <script>
    function checkAnswer(tabId, keyword) {
      const userInput = document.getElementById(tabId + "_input").value;
      const outputDiv = document.getElementById(tabId + "_result");
      if (userInput.includes(keyword)) {
        outputDiv.textContent = "тЬЕ Correct! You used the keyword: " + keyword;
        outputDiv.style.color = "green";
      } else {
        outputDiv.textContent = "тЭМ Missing keyword: " + keyword;
        outputDiv.style.color = "red";
      }
    }
  </script>

</script>

  <hr>
  <h2>ЁЯУШ Learn N─АRA</h2>
  <div class="tabs">
    <button onclick="showTab('lesson1')">1я╕ПтГг Basics</button>
    <button onclick="showTab('lesson2')">2я╕ПтГг Recursion</button>
    <button onclick="showTab('lesson3')">3я╕ПтГг Multi-Agent</button>
  </div>
  <div id="lesson1" class="tab" style="display:block;">
    <textarea id="lesson1_input" style="width:100%;height:100px;" placeholder="Write your agent code here..."></textarea><br>
    <button onclick="checkAnswer('lesson1', 'рдкреБрд░реБрд╖рдГ')">Check Answer</button>
    <div id="lesson1_result" style="margin-top:10px;"></div>
    <h3>ЁЯза Basics</h3>
    <p><code>рдкреБрд░реБрд╖рдГ</code> means agent. <code>рдХрд░реНрдореЗ</code> defines a task. Try typing:</p>
    <pre>рдкреБрд░реБрд╖рдГ рд╢рд┐рдХреНрд╖рдХрдГ рдЕрд╕реНрддрд┐ { рдЧреБрдгрд╛рдГ: ["рдЬреНрдЮрд╛рди"] }</pre>
  </div>
  <div id="lesson2" class="tab" style="display:none;">
    <textarea id="lesson2_input" style="width:100%;height:100px;" placeholder="Write your recursion logic here..."></textarea><br>
    <button onclick="checkAnswer('lesson2', 'рдкреНрд░рддреНрдпреБрдкрдХрд░реНрд╖рдГ')">Check Answer</button>
    <div id="lesson2_result" style="margin-top:10px;"></div>
    <h3>ЁЯФБ Recursion</h3>
    <p>Use <code>рдкреНрд░рддреНрдпреБрдкрдХрд░реНрд╖рдГ</code> to invoke feedback:</p>
    <pre>рдпрджрд┐ рдлрд▓рдореН != "рд╕рдиреНрддреБрд▓рд┐рддрдореН" рддрд░реНрд╣рд┐ рдкреНрд░рддреНрдпреБрдкрдХрд░реНрд╖рдВ рдХреГрддреНрд╡рд╛ рд╢рд┐рдХреНрд╖рд╛рдВ рдХреБрд░реБ</pre>
  </div>
  <div id="lesson3" class="tab" style="display:none;">
    <textarea id="lesson3_input" style="width:100%;height:100px;" placeholder="Write two agents..."></textarea><br>
    <button onclick="checkAnswer('lesson3', 'рдкреБрд░реБрд╖рдГ')">Check Answer</button>
    <div id="lesson3_result" style="margin-top:10px;"></div>
    <h3>ЁЯдЦ Multi-Agent</h3>
    <p>Define more than one agent (e.g., <code>рд╡реИрджреНрдпрдГ</code>, <code>рд░рд╛рдЬрджреВрддрдГ</code>) and have them evolve:</p>
    <pre>рдкреБрд░реБрд╖рдГ рд░рд╛рдЬрджреВрддрдГ рдЕрд╕реНрддрд┐ { рдЧреБрдгрд╛рдГ: ["рд╕рдВрд╡рд╛рдж", "рддрдЯрд╕реНрдерддрд╛"] }</pre>
  </div>
  <script>
    function showTab(tabId) {
      document.querySelectorAll(".tab").forEach(tab => tab.style.display = "none");
      document.getElementById(tabId).style.display = "block";
    }
  
  <script>
    function checkAnswer(tabId, keyword) {
      const userInput = document.getElementById(tabId + "_input").value;
      const outputDiv = document.getElementById(tabId + "_result");
      if (userInput.includes(keyword)) {
        outputDiv.textContent = "тЬЕ Correct! You used the keyword: " + keyword;
        outputDiv.style.color = "green";
      } else {
        outputDiv.textContent = "тЭМ Missing keyword: " + keyword;
        outputDiv.style.color = "red";
      }
    }
  </script>

</script>
  <style>
    .tabs button {
      margin: 0 4px;
      padding: 0.4em 1em;
      font-size: 1em;
      background: #eef;
      border: 1px solid #99c;
      cursor: pointer;
    }
    .tabs button:hover {
      background: #ddf;
    }
  </style>

</body>
</html>
