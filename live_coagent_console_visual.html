
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NƒÄRA Recursive Console: Visual Evolution</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: sans-serif; padding: 1em; background: #fffaf5; }
    textarea, pre, canvas { width: 100%; margin-top: 1em; }
    button { padding: 0.5em 1em; margin-top: 1em; font-size: 1em; }
    .section { margin-bottom: 2em; }
    #memory, #stack, #log { white-space: pre-wrap; background: #efefef; padding: 1em; border-radius: 6px; }
  </style>
</head>
<body>
  <h1>üìä NƒÄRA Recursive Console: Visual Evolution</h1>

  <div class="section">
    <h2>üßæ Root Agent Code</h2>
    <textarea id="naraCode" rows="8" placeholder="‡§è‡§ú‡•á‡§Ç‡§ü '‡§®‡§ø‡§∞‡•Ä‡§ï‡•ç‡§∑‡§ï': ‡§Ø‡§¶‡§ø ..."></textarea>
    <button onclick="runRecursiveAgent()">Run Recursive Agent</button>
  </div>

  <div class="section">
    <h2>üë• Agent Stack</h2>
    <pre id="stack"></pre>
  </div>

  <div class="section">
    <h2>üß† Shared Memory</h2>
    <pre id="memory">{}</pre>
  </div>

  <div class="section">
    <h2>üìà Memory Evolution</h2>
    <canvas id="memoryChart" height="100"></canvas>
  </div>

  <div class="section">
    <h2>üìú Execution Log</h2>
    <pre id="log"></pre>
  </div>

  <script>
    let sharedMemory = {
      '‡§∏‡§§‡•ç‡§∞‡§É': '‡§≠‡•ç‡§∞‡§∑‡•ç‡§ü‡§É',
      '‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡§É': 'LLM connection failed',
    };
    let agentStack = [];
    let memoryEvolution = [];

    function spawnAgent(name, logic) {
      return {
        name,
        memory: JSON.parse(JSON.stringify(sharedMemory)),
        code: logic
      };
    }

    function recordMemoryStep(stepLabel) {
      memoryEvolution.push({ label: stepLabel, size: Object.keys(sharedMemory).length });
      updateMemoryChart();
    }

    async function runRecursiveAgent() {
      const code = document.getElementById('naraCode').value;
      const log = [];

      agentStack = [spawnAgent('‡§®‡§ø‡§∞‡•Ä‡§ï‡•ç‡§∑‡§ï', code)];
      memoryEvolution = [];
      recordMemoryStep("‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§");

      for (let i = 0; i < agentStack.length; i++) {
        const agent = agentStack[i];
        log.push(`üîÅ Executing Agent: ${agent.name}`);

        if (agent.code.includes("‡§∏‡§§‡•ç‡§∞‡§É") && agent.memory['‡§∏‡§§‡•ç‡§∞‡§É'] === '‡§≠‡•ç‡§∞‡§∑‡•ç‡§ü‡§É') {
          log.push("üìå ‡§∏‡§§‡•ç‡§∞‡§É == ‡§≠‡•ç‡§∞‡§∑‡•ç‡§ü‡§É ‚Üí ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•Å‡§™‡§ï‡§∞‡•ç‡§∑‡§Ç in process...");

          if (agent.code.includes("‡§∏‡•ç‡§Æ‡•É‡§§‡§ø[\"‡§∏‡•Ç‡§§‡•ç‡§∞‡§É\"]")) {
            agent.memory["‡§∏‡•Ç‡§§‡•ç‡§∞‡§É"] = "https://github.com/Adtiya/nara-language";
            log.push("üîó Updated ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø['‡§∏‡•Ç‡§§‡•ç‡§∞‡§É']");
          }

          if (agent.code.includes("‡§Ü‡§π‡•ç‡§µ‡§æ‡§®‡§Ç")) {
            const mockRes = await fetch("https://jsonplaceholder.typicode.com/posts/3").then(r => r.json());
            agent.memory["‡§®‡§µ‡§æ‡§ö‡§æ‡§∞‡§É"] = "LLM: " + mockRes.title;
            log.push("üì° ‡§Ü‡§π‡•ç‡§µ‡§æ‡§®‡§Ç fetched: " + mockRes.title);
          }

          if (agent.code.includes("‡§è‡§ú‡•á‡§Ç‡§ü")) {
            agentStack.push(spawnAgent('‡§∏‡•Å‡§ß‡§æ‡§∞‡§ï', `
              ‡§Ø‡§¶‡§ø ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø["‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡§É"]:
                  ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø["‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡§É"] = "Resolved"
                  ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø["‡§®‡§µ‡§æ‡§ö‡§æ‡§∞‡§É"] = "Self-healed"
            `));
            log.push("üå± Agent '‡§∏‡•Å‡§ß‡§æ‡§∞‡§ï' spawned.");
          }

          agent.memory['‡§∏‡§§‡•ç‡§∞‡§É'] = '‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§';
          log.push("‚úÖ Agent '‡§∏‡§§‡•ç‡§∞‡§É' updated to '‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§'");
        } else {
          log.push("‚ö†Ô∏è No matching logic for: " + agent.name);
        }

        Object.assign(sharedMemory, agent.memory);
        recordMemoryStep(agent.name);
      }

      document.getElementById('memory').textContent = JSON.stringify(sharedMemory, null, 2);
      document.getElementById('stack').textContent = agentStack.map(a => a.name).join(" ‚Üí ");
      document.getElementById('log').textContent = log.join('\n');
    }

    function updateMemoryChart() {
      const labels = memoryEvolution.map(m => m.label);
      const data = memoryEvolution.map(m => m.size);
      memoryChart.data.labels = labels;
      memoryChart.data.datasets[0].data = data;
      memoryChart.update();
    }

    const ctx = document.getElementById('memoryChart').getContext('2d');
    const memoryChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'üß† Memory Size Over Time',
          data: [],
          borderColor: 'blue',
          borderWidth: 2,
          fill: false,
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            ticks: { stepSize: 1 }
          }
        }
      }
    });
  </script>
</body>
</html>
